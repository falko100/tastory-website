---
---

<section class="cta-section" id="download">
  <div class="cta-inner reveal">
    <div class="section-tag" style="justify-content:center">Blijf op de hoogte</div>
    <h2>Klaar om restaurants in een <em>nieuw licht</em> te zien?</h2>
    <p>Op de hoogte blijven van alle Tastory nieuws? Meld je aan voor de nieuwsbrief en ontvang updates over de lancering van onze app!</p>
    <form class="email-form" id="newsletter-form">
      <input type="email" id="newsletter-email" placeholder="Jouw e-mailadres" required aria-label="E-mailadres">
      <button type="submit">Aanmelden</button>
    </form>
    <div class="form-feedback" id="form-feedback"></div>
    <div class="cta-note">Geen spam. Altijd opzegbaar. Binnenkort beschikbaar op iOS &amp; Android.</div>
  </div>
</section>

<script>
  const form = document.getElementById('newsletter-form') as HTMLFormElement;
  const emailInput = document.getElementById('newsletter-email') as HTMLInputElement;
  const feedback = document.getElementById('form-feedback') as HTMLDivElement;
  const submitBtn = form.querySelector('button') as HTMLButtonElement;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = emailInput.value.trim();
    if (!email) return;

    submitBtn.disabled = true;
    submitBtn.textContent = 'Verzenden...';

    try {
      const res = await fetch('https://formsubmit.co/ajax/Info@tastory.nl', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
        body: JSON.stringify({
          email,
          _subject: 'Nieuwe nieuwsbrief aanmelding â€” Tastory',
        }),
      });

      if (res.ok) {
        feedback.textContent = 'Bedankt voor je aanmelding! We houden je op de hoogte.';
        feedback.className = 'form-feedback form-feedback--success';
        emailInput.value = '';
      } else {
        throw new Error('Submit failed');
      }
    } catch {
      feedback.textContent = 'Er ging iets mis. Probeer het later opnieuw.';
      feedback.className = 'form-feedback form-feedback--error';
    }

    submitBtn.disabled = false;
    submitBtn.textContent = 'Aanmelden';

    setTimeout(() => {
      feedback.textContent = '';
      feedback.className = 'form-feedback';
    }, 5000);
  });
</script>

<style>
  .cta-section {
    padding: 8rem 3rem;
    text-align: center;
    position: relative;
    background: var(--beige);
    max-width: 100%;
  }

  .cta-section::before {
    content: '';
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 600px; height: 600px;
    background: radial-gradient(circle, rgba(255, 142, 62, 0.06) 0%, transparent 60%);
    pointer-events: none;
  }

  .cta-inner {
    position: relative;
    max-width: 620px;
    margin: 0 auto;
  }

  .cta-inner h2 {
    font-family: var(--serif);
    font-size: clamp(2rem, 3.5vw, 3.2rem);
    color: var(--text);
    font-weight: 400;
    line-height: 1.15;
    margin-bottom: 1.2rem;
  }

  .cta-inner h2 em {
    color: var(--orange);
    font-style: italic;
  }

  .cta-inner > p {
    font-size: 1.05rem;
    color: var(--text-muted);
    line-height: 1.7;
    margin-bottom: 2.5rem;
  }

  .email-form {
    display: flex;
    max-width: 520px;
    margin: 0 auto;
    border: 1px solid rgba(136, 101, 69, 0.15);
    border-radius: 100px;
    overflow: hidden;
    background: var(--white);
    box-shadow: 0 4px 20px rgba(136, 101, 69, 0.06);
  }

  .email-form input {
    flex: 1;
    padding: 1rem 1.8rem;
    background: transparent;
    border: none;
    color: var(--text);
    font-family: var(--sans);
    font-size: 1rem;
    outline: none;
  }

  .email-form input::placeholder {
    color: var(--text-muted);
    opacity: 0.6;
  }

  .email-form button {
    background: var(--orange);
    color: var(--white);
    border: none;
    padding: 1rem 2rem;
    font-family: var(--sans);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s;
    white-space: nowrap;
    border-radius: 0 100px 100px 0;
  }

  .email-form button:hover { background: var(--orange-dark); }

  .form-feedback {
    font-size: 1rem;
    margin-top: 1rem;
    min-height: 1.5rem;
    transition: all 0.3s;
  }

  .form-feedback--success {
    color: #2e7d32;
  }

  .form-feedback--error {
    color: #c62828;
  }

  .cta-note {
    font-size: 1rem;
    color: var(--text-muted);
    opacity: 0.6;
    margin-top: 1rem;
  }

  @media (max-width: 640px) {
    .email-form { flex-direction: column; border-radius: 16px; }
    .email-form button { width: 100%; border-radius: 0 0 16px 16px; }
  }
</style>
